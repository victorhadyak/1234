receivers:
  otlp:
    protocols:
      grpc:
      http:

processors:
  batch:
    timeout: 5s
  transform:
    metric_statements:
      - context: datapoint
        statements:
          # Example of renaming and ensuring metrics are counters
          - rename(metric.name, "original_metric_name", "new_metric_name")
          - set(metric.type, "counter")
          - set(metric.unit, "1")
          - set(attributes["job"], "my_job")
          - set(attributes["instance"], "my_instance")

exporters:
  prometheusremotewrite:
    endpoint: "http://<pushgateway_host>:9091/metrics"
    headers:
      X-Prometheus-Remote-Write-Version: "0.1.0"

service:
  pipelines:
    metrics:
      receivers: [otlp]
      processors: [batch, transform]
      exporters: [prometheusremotewrite]
